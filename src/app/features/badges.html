<div class="badges-page">
  <!-- Header -->
  <div class="page-header">
    <h1>📊 Statistiques des Badges</h1>
    <p>Analyse et distribution des badges sur la plateforme SIRA</p>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>Chargement des statistiques...</p>
  </div>

  <!-- KPI Cards -->
  <div *ngIf="!loading" class="kpi-grid">
    <div class="kpi-card">
      <div class="kpi-icon">🏆</div>
      <div class="kpi-content">
        <h3>{{ totalBadges }}</h3>
        <p>Total badges</p>
      </div>
    </div>

    <div class="kpi-card">
      <div class="kpi-icon">👥</div>
      <div class="kpi-content">
        <h3>{{ totalUsersWithBadges }}</h3>
        <p>Utilisateurs avec badges</p>
      </div>
    </div>

    <div class="kpi-card">
      <div class="kpi-icon">📈</div>
      <div class="kpi-content">
        <h3>{{ averageBadgesPerUser | number:'1.1-1' }}</h3>
        <p>Moyenne par utilisateur</p>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div *ngIf="!loading" class="charts-grid">
    <!-- Distribution Chart -->
    <div class="chart-card">
      <h3>📊 Distribution par Type</h3>
      <div class="chart-container">
        <canvas id="distributionChart" width="400" height="300"></canvas>
      </div>
    </div>

    <!-- Progress Chart -->
    <div class="chart-card">
      <h3>📈 Progression Mensuelle</h3>
      <div class="chart-container">
        <canvas id="progressChart" width="400" height="300"></canvas>
      </div>
    </div>
  </div>

  <!-- Top Badges -->
  <div *ngIf="!loading" class="card">
    <h3>⭐ Badges les Plus Attribués</h3>
    <div class="top-badges-list">
      <div *ngFor="let badge of topBadges; let i = index" class="top-badge-item">
        <span class="rank">{{ i + 1 }}</span>
        <span class="badge-name">{{ badge.key }}</span>
        <span class="badge-count">{{ badge.count }} attributions</span>
      </div>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-state">
    <div class="error-icon">⚠️</div>
    <h3>Erreur de chargement</h3>
    <p>{{ error }}</p>
    <button class="btn btn-primary" (click)="loadData()">Réessayer</button>
  </div>
</div>