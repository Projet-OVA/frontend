<div class="users-page">
  <h2>Liste des citoyens</h2>

  <div *ngIf="loading" class="loading">Chargement...</div>

  <table class="table" *ngIf="!loading && users.length">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Prénom</th>
        <th>Email</th>
        <th>Username</th>
        <th>Téléphone</th>
        <th>Créé le</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let u of users">
        <td>{{ u.nom }}</td>
        <td>{{ u.prenom }}</td>
        <td>{{ u.email }}</td>
        <td>{{ u.username }}</td>
        <td>{{ u.phoneNumber || '-' }}</td>
        <td>{{ u.createdAt | date : 'short' }}</td>
        <td>
          <button class="btn-ghost" (click)="openEditDialog(u)">✏️</button>
          <button class="btn-danger" (click)="deleteUser(u)">🗑️</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="!loading && !users.length" class="muted">Aucun citoyen trouvé</div>

  <!-- Edit Dialog -->
  <div class="dialog" *ngIf="showEditDialog && selectedUser">
    <div class="dialog-content">
      <h3>Modifier citoyen</h3>
      <input type="text" placeholder="Nom" [(ngModel)]="selectedUser.nom" />
      <input type="text" placeholder="Prénom" [(ngModel)]="selectedUser.prenom" />
      <input type="email" placeholder="Email" [(ngModel)]="selectedUser.email" />
      <input type="text" placeholder="Username" [(ngModel)]="selectedUser.username" />
      <input type="text" placeholder="Téléphone" [(ngModel)]="selectedUser.phoneNumber" />

      <div class="actions">
        <button class="btn" (click)="showEditDialog = false">Annuler</button>
        <button class="btn btn-primary" (click)="saveUser()" [disabled]="saving">
          {{ saving ? 'Enregistrement...' : 'Enregistrer' }}
        </button>
      </div>
    </div>
  </div>
</div>
