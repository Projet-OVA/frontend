<div class="courses-page">
  <div class="toolbar card">
    <div class="left">
      <button class="btn btn-primary" (click)="openDialog()">+ Nouveau cours</button>
    </div>

    <div class="right">
      <select [(ngModel)]="filterStatus">
        <option value="">Tous</option>
        <option value="DRAFT">Brouillons</option>
        <option value="PUBLISHED">Publi√©s</option>
      </select>
    </div>
  </div>

  <div class="card">
    <table class="table" role="table" aria-label="Liste des cours">
      <thead>
        <tr>
          <th>Nom</th>
          <th>Cat√©gorie</th>
          <th>Description</th>
          <th>Statut</th>
          <th style="width:160px">Actions</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let c of courses" [hidden]="filterStatus && c.status !== filterStatus">
          <td>{{ c.nom }}</td>
          <td>{{ c.category }}</td>
          <td class="desc">{{ c.description }}</td>
          <td>{{ c.status }}</td>
          <td>
            <button class="btn-ghost" title="√âditer" (click)="openDialog(c)">‚úèÔ∏è</button>
            <button class="btn-danger" title="Supprimer" (click)="delete(c)">üóëÔ∏è</button>
            <button class="btn" title="Publier" (click)="publish(c)" *ngIf="c.status !== 'PUBLISHED'">üì¢</button>
          </td>
        </tr>

        <tr *ngIf="!courses?.length">
          <td colspan="5" class="muted">Aucun cours trouv√©</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- modal / dialog -->
  <div class="dialog" *ngIf="showDialog" role="dialog" aria-modal="true">
    <div class="dialog-content">
      <h3>{{ newCourse?.id ? 'Modifier' : 'Cr√©er' }} cours</h3>

      <input type="text" placeholder="Nom*" [(ngModel)]="newCourse.nom" />

      <select [(ngModel)]="newCourse.category">
        <option value="">Choisir une cat√©gorie</option>
        <option value="ENVIRONNEMENT">Environnement</option>
        <option value="DROIT_DU_CITOYEN">Droit du citoyen</option>
        <option value="DEVOIR_DU_CITOYEN">Devoir du citoyen</option>
      </select>

      <textarea placeholder="Description" [(ngModel)]="newCourse.description"></textarea>

      <label>
        Statut
        <select [(ngModel)]="newCourse.status">
          <option value="DRAFT">Brouillon</option>
          <option value="PUBLISHED">Publi√©</option>
        </select>
      </label>

      <div class="file-row">
        <label class="file-label">Fichier (optionnel)</label>
        <input type="file" (change)="onFileChange($event)" />
      </div>

      <div class="actions">
        <button class="btn" (click)="showDialog = false" type="button">Annuler</button>
        <button class="btn btn-primary" (click)="save()" [disabled]="saving">
          {{ saving ? 'Enregistrement...' : 'Enregistrer' }}
        </button>
      </div>
    </div>
  </div>
</div>
